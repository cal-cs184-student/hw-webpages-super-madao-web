<html>
  <head>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=default'></script>
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
		<style>
			h1 {
				text-align: center;
				color: #00B4FF;
			}

			h2 {
				color: #00B4FF;
			}

			h3 {
				color: #00B4FF;
			}

			a {
				color: #00B4FF;
			}

			.container {
				margin: 0 auto;
				padding: 60px 20%;
			}

			figure {
				text-align: center;
			}

			img {
				display: inline-block;
			}

			body {
				font-family: 'Open Sans', serif;
				background-color: #15171e;
				color: white;
			}
		</style>
	</head>
  <body>
    <div class="container">
      <h1>CS184/284A Spring 2025 Homework 3 Write-Up</h1>
      <div style="text-align: center">Annika Liu, Candice Yang</div>

      <br />

      <a href="https://cal-cs184-student.github.io/hw-webpages-super-madao-web/"
        >Link</a> to webpage.
      Link to GitHub repository:
      <a href="https://github.com/cal-cs184-student/sp25-hw2-madao-kleta.git"
        >github.com/cal-cs184-student/sp25-hw2-madao-kleta.git</a
      >

      <figure>
        <img
          src="cornell.png"
          alt="Cornell Boxes with Bunnies"
          style="width: 70%"
        />
        <figcaption></figcaption>
      </figure>

      <!--
		We've already added one heading per part, to make your write-up as navigable when grading. Please fit your write-up within these sections!
		-->

      <h2>Overview</h2>
      Give a high-level overview of what you implemented in this homework. Think
      about what you've built as a whole. Share your thoughts on what
      interesting things you've learned from completing the homework.

      <h2>Part 1: Ray Generation and Scene Intersection</h2>
      <h3>
        1. Walk through the ray generation and primitive intersection parts of
        the rendering pipeline.
      </h3>

      <!-- Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. -->
      The ray generation process begins in the camera class, specifically in the
      Camera::generate_ray() function. Here's how it works: The function takes
      normalized image coordinates (x, y) as input, where (0,0) corresponds to
      the bottom-left corner of the image and (1,1) to the top-right corner.
      These normalized coordinates are transformed to camera space. In camera
      space, the camera is positioned at (0,0,0) and looks along the negative Z
      axis. A virtual camera sensor is defined at z = -1, with dimensions
      determined by the horizontal and vertical field of view angles (hFov and
      vFov). The normalized image coordinates are mapped to points on this
      sensor. A ray is created starting from the camera origin (0,0,0) and
      passing through the calculated point on the sensor. This gives the ray
      direction in camera space. Finally, the ray is transformed from camera
      space to world space using the camera-to-world transformation matrix. Both
      the ray origin and direction are transformed. The
      PathTracer::raytrace_pixel() function then uses this ray generation
      process to create rays for each pixel: For each pixel with coordinates (x,
      y), it creates multiple sample rays (ns_aa samples) to perform
      anti-aliasing. For each sample, it slightly perturbs the pixel coordinates
      using a random sampler to generate rays that pass through different parts
      of the pixel. It calls Camera::generate_ray() to create each ray. It
      estimates the radiance along each ray and averages the results to get the
      final pixel color. Once rays are generated, they need to be tested for
      intersection with scene primitives (triangles and spheres). This is
      implemented in the triangle and sphere classes as Triangle::intersect()and
      Sphere::intersect() function. For both primitives, the functions also
      update the ray's max_t value to the nearest intersection found so far,
      which helps optimize future intersection tests.

      <h3>
        2. Explain the triangle intersection algorithm you implemented in your
        own words.
      </h3>
      <p>
        I used the lecture slide of Moller Trumbore Algorithm to implement the
        triangle intersection algorithm, which increases the efficiency of this
        algorithm. 1. The algorithm first computes two edges of the triangle:
        edge1 = p2 - p1 and edge2 = p3 - p1 2. It then calculates a vector pvec
        by taking the cross product of the ray direction and edge2: pvec =
        cross(r.d, edge2) 3. The determinant det = dot(edge1, pvec) is
        calculated, which is proportional to the volume of the parallelpiped
        formed by the ray direction and the two edges. If the determinant is
        close to zero, the ray is parallel to the triangle plane, so there's no
        intersection. 4. For valid intersections, barycentric coordinates (u, v)
        are calculated: u = dot(tvec, pvec) * inv_det where tvec = r.o - p v =
        dot(r.d, qvec) * inv_det where qvec = cross(tvec, edge1) 5. The
        barycentric coordinates determine if the intersection point is inside
        the triangle: The point is inside if u ≥ 0, v ≥ 0, and u + v ≤ 1.The
        third barycentric coordinate w = 1 - u - v implicitly 6. The
        intersection distance t along the ray is calculated as t = dot(edge2,
        qvec) * inv_det. 7. Finally, for valid intersections, the algorithm
        updates the ray's max_t value and, in the full intersection method, also
        computes the interpolated normal at the intersection point using the
        barycentric coordinates.
      </p>
      <p>
        Here is an example 2x2 gridlike structure using an HTML table. Each
        <b>tr</b> is a row and each <b>td</b> is a column in that row. You might
        find this useful for framing and showing your result images in an
        organized fashion.
      </p>
      <div style="display: flex; flex-direction: column; align-items: center">
        <table
          style="width: 100%; text-align: center; border-collapse: collapse"
        >
          <tr>
            <td style="text-align: center">
              <img src="cornell.png" width="400px" />
              <figcaption>Caption goes here.</figcaption>
            </td>
            <td style="text-align: center">
              <img src="cornell.png" width="400px" />
              <figcaption>Caption goes here.</figcaption>
            </td>
          </tr>
          <tr>
            <td style="text-align: center">
              <img src="cornell.png" width="400px" />
              <figcaption>Caption goes here.</figcaption>
            </td>
            <td style="text-align: center">
              <img src="cornell.png" width="400px" />
              <figcaption>Caption goes here.</figcaption>
            </td>
          </tr>
        </table>
      </div>

      <h2>Part 2: Bounding Volume Hierarchy</h2>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
      velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
      est laborum.

      <h2>Part 3: Direct Illumination</h2>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
      velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
      est laborum.

      <h2>Part 4: Global Illumination</h2>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
      velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
      est laborum.

      <h2>Part 5: Adaptive Sampling</h2>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
      velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
      est laborum.

      <h2>(Optional) Part 6: Extra Credit Opportunities</h2>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
      velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
      est laborum.

      <h2>Additional Notes (please remove)</h2>
      <ul>
        <li>
          You can also add code if you'd like as so: <code>code code code</code>
        </li>
        <li>
          If you'd like to add math equations,
          <ul>
            <li>
              You can write inline equations like so: \( a^2 + b^2 = c^2 \)
            </li>
            <li>
              You can write display equations like so: \[ a^2 + b^2 = c^2 \]
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </body>
</html>
